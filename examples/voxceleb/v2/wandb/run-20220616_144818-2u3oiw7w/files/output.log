
exp/ResNet34-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150_rev-data/models already exists !!!
[ INFO : 2022-06-16 14:48:25,986 ] - training on multiple gpus, this gpu 0
[ INFO : 2022-06-16 14:48:25,986 ] - exp_dir is: exp/ResNet34-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150_rev-data
[ INFO : 2022-06-16 14:48:25,986 ] - <== Passed Arguments ==>
[ INFO : 2022-06-16 14:48:25,987 ] - {'checkpoint': 'exp/ResNet34-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150/models/avg_model.pt',
[ INFO : 2022-06-16 14:48:25,987 ] -  'data_type': 'shard',
[ INFO : 2022-06-16 14:48:25,987 ] -  'dataloader_args': {'batch_size': 192,
[ INFO : 2022-06-16 14:48:25,987 ] -                      'drop_last': True,
[ INFO : 2022-06-16 14:48:25,988 ] -                      'num_workers': 4,
[ INFO : 2022-06-16 14:48:25,988 ] -                      'pin_memory': False,
[ INFO : 2022-06-16 14:48:25,988 ] -                      'prefetch_factor': 4},
[ INFO : 2022-06-16 14:48:25,988 ] -  'dataset_args': {'aug_prob': 0.6,
[ INFO : 2022-06-16 14:48:25,988 ] -                   'fbank_args': {'dither': 1.0,
[ INFO : 2022-06-16 14:48:25,988 ] -                                  'frame_length': 25,
[ INFO : 2022-06-16 14:48:25,988 ] -                                  'frame_shift': 10,
[ INFO : 2022-06-16 14:48:25,988 ] -                                  'num_mel_bins': 80},
[ INFO : 2022-06-16 14:48:25,988 ] -                   'num_frms': 200,
[ INFO : 2022-06-16 14:48:25,988 ] -                   'shuffle': True,
[ INFO : 2022-06-16 14:48:25,988 ] -                   'shuffle_args': {'shuffle_size': 2500},
[ INFO : 2022-06-16 14:48:25,989 ] -                   'spec_aug': False,
[ INFO : 2022-06-16 14:48:25,989 ] -                   'spec_aug_args': {'max_f': 8,
[ INFO : 2022-06-16 14:48:25,989 ] -                                     'max_t': 10,
[ INFO : 2022-06-16 14:48:25,989 ] -                                     'num_f_mask': 1,
[ INFO : 2022-06-16 14:48:25,989 ] -                                     'num_t_mask': 1,
[ INFO : 2022-06-16 14:48:25,989 ] -                                     'prob': 0.6},
[ INFO : 2022-06-16 14:48:25,989 ] -                   'speed_perturb': True},
[ INFO : 2022-06-16 14:48:25,989 ] -  'exp_dir': 'exp/ResNet34-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150_rev-data',
[ INFO : 2022-06-16 14:48:25,989 ] -  'gpus': [0, 1, 2, 3],
[ INFO : 2022-06-16 14:48:25,989 ] -  'log_batch_interval': 100,
[ INFO : 2022-06-16 14:48:25,989 ] -  'loss': 'CrossEntropyLoss',
[ INFO : 2022-06-16 14:48:25,989 ] -  'loss_args': {},
[ INFO : 2022-06-16 14:48:25,990 ] -  'margin_scheduler': 'MarginScheduler',
[ INFO : 2022-06-16 14:48:25,990 ] -  'margin_update': {'final_margin': 0.2,
[ INFO : 2022-06-16 14:48:25,990 ] -                    'fix_start_epoch': 40,
[ INFO : 2022-06-16 14:48:25,990 ] -                    'increase_start_epoch': 20,
[ INFO : 2022-06-16 14:48:25,990 ] -                    'increase_type': 'exp',
[ INFO : 2022-06-16 14:48:25,990 ] -                    'initial_margin': 0.0,
[ INFO : 2022-06-16 14:48:25,990 ] -                    'update_margin': True},
[ INFO : 2022-06-16 14:48:25,990 ] -  'model': 'ResNet34',
[ INFO : 2022-06-16 14:48:25,990 ] -  'model_args': {'embed_dim': 256, 'feat_dim': 80, 'pooling_func': 'TSTP'},
[ INFO : 2022-06-16 14:48:25,990 ] -  'model_init': 'exp/ResNet101-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150/models/model_45.pt',
[ INFO : 2022-06-16 14:48:25,990 ] -  'noise_data': 'data/musan/lmdb',
[ INFO : 2022-06-16 14:48:25,990 ] -  'num_avg': 10,
[ INFO : 2022-06-16 14:48:25,991 ] -  'num_epochs': 150,
[ INFO : 2022-06-16 14:48:25,991 ] -  'optimizer': 'SGD',
[ INFO : 2022-06-16 14:48:25,991 ] -  'optimizer_args': {'momentum': 0.9, 'nesterov': True, 'weight_decay': 0.0001},
[ INFO : 2022-06-16 14:48:25,991 ] -  'projection_args': {'easy_margin': False,
[ INFO : 2022-06-16 14:48:25,991 ] -                      'project_type': 'arc_margin',
[ INFO : 2022-06-16 14:48:25,991 ] -                      'scale': 32.0},
[ INFO : 2022-06-16 14:48:25,991 ] -  'reverb_data': 'data/rirs/lmdb',
[ INFO : 2022-06-16 14:48:25,991 ] -  'save_epoch_interval': 5,
[ INFO : 2022-06-16 14:48:25,991 ] -  'scheduler': 'ExponentialDecrease',
[ INFO : 2022-06-16 14:48:25,991 ] -  'scheduler_args': {'final_lr': 5e-05, 'initial_lr': 0.1, 'warm_up_epoch': 6},
[ INFO : 2022-06-16 14:48:25,991 ] -  'seed': 42,
[ INFO : 2022-06-16 14:48:25,991 ] -  'train_data': 'data/train/shard.list',
[ INFO : 2022-06-16 14:48:25,991 ] -  'train_label': 'data/train/utt2spk'}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'seg_1.weight', 'seg_1.bias', 'seg_bn_1.running_mean', 'seg_bn_1.running_var', 'seg_bn_1.num_batches_tracked', 'seg_2.weight', 'seg_2.bias', 'projection.weight'])
[ INFO : 2022-06-16 14:48:30,549 ] - <== Data statistics ==>
[ INFO : 2022-06-16 14:48:30,549 ] - train data num: 1747308, spk num: 29501
[ INFO : 2022-06-16 14:48:30,559 ] - <== Dataloaders ==>
[ INFO : 2022-06-16 14:48:30,559 ] - train dataloaders created
[ INFO : 2022-06-16 14:48:30,559 ] - loader size: 2275
[ INFO : 2022-06-16 14:48:30,559 ] - <== Model ==>
[ INFO : 2022-06-16 14:48:30,621 ] - Load initial model from exp/ResNet101-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150/models/model_45.pt
[ INFO : 2022-06-16 14:48:30,898 ] - ResNet(
[ INFO : 2022-06-16 14:48:30,898 ] -   (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,898 ] -   (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,898 ] -   (layer1): Sequential(
[ INFO : 2022-06-16 14:48:30,898 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 14:48:30,898 ] -       (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,899 ] -       (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,899 ] -       (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,899 ] -       (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,899 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,899 ] -     )
[ INFO : 2022-06-16 14:48:30,899 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 14:48:30,899 ] -       (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,899 ] -       (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,899 ] -       (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,899 ] -       (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,899 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,899 ] -     )
[ INFO : 2022-06-16 14:48:30,900 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 14:48:30,900 ] -       (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,900 ] -       (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,900 ] -       (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,900 ] -       (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,900 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,900 ] -     )
[ INFO : 2022-06-16 14:48:30,900 ] -   )
[ INFO : 2022-06-16 14:48:30,900 ] -   (layer2): Sequential(
[ INFO : 2022-06-16 14:48:30,900 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 14:48:30,900 ] -       (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,900 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,901 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,901 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,901 ] -       (shortcut): Sequential(
[ INFO : 2022-06-16 14:48:30,901 ] -         (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
[ INFO : 2022-06-16 14:48:30,901 ] -         (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,901 ] -       )
[ INFO : 2022-06-16 14:48:30,901 ] -     )
[ INFO : 2022-06-16 14:48:30,901 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 14:48:30,901 ] -       (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,901 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,901 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,901 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,901 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,902 ] -     )
[ INFO : 2022-06-16 14:48:30,902 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 14:48:30,902 ] -       (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,902 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,902 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,902 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,902 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,902 ] -     )
[ INFO : 2022-06-16 14:48:30,902 ] -     (3): BasicBlock(
[ INFO : 2022-06-16 14:48:30,902 ] -       (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,902 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,902 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,903 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,903 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,903 ] -     )
[ INFO : 2022-06-16 14:48:30,903 ] -   )
[ INFO : 2022-06-16 14:48:30,903 ] -   (layer3): Sequential(
[ INFO : 2022-06-16 14:48:30,903 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 14:48:30,903 ] -       (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,903 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,903 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,903 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,903 ] -       (shortcut): Sequential(
[ INFO : 2022-06-16 14:48:30,904 ] -         (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
[ INFO : 2022-06-16 14:48:30,904 ] -         (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,904 ] -       )
[ INFO : 2022-06-16 14:48:30,904 ] -     )
[ INFO : 2022-06-16 14:48:30,904 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 14:48:30,904 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,904 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,904 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,904 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,904 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,904 ] -     )
[ INFO : 2022-06-16 14:48:30,904 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 14:48:30,905 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,905 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,905 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,905 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,905 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,905 ] -     )
[ INFO : 2022-06-16 14:48:30,905 ] -     (3): BasicBlock(
[ INFO : 2022-06-16 14:48:30,905 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,905 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,905 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,905 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,905 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,906 ] -     )
[ INFO : 2022-06-16 14:48:30,906 ] -     (4): BasicBlock(
[ INFO : 2022-06-16 14:48:30,906 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,906 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,906 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,906 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,906 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,906 ] -     )
[ INFO : 2022-06-16 14:48:30,906 ] -     (5): BasicBlock(
[ INFO : 2022-06-16 14:48:30,906 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,906 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,906 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,907 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,907 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,907 ] -     )
[ INFO : 2022-06-16 14:48:30,907 ] -   )
[ INFO : 2022-06-16 14:48:30,907 ] -   (layer4): Sequential(
[ INFO : 2022-06-16 14:48:30,907 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 14:48:30,907 ] -       (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,907 ] -       (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,907 ] -       (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,907 ] -       (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,907 ] -       (shortcut): Sequential(
[ INFO : 2022-06-16 14:48:30,908 ] -         (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
[ INFO : 2022-06-16 14:48:30,908 ] -         (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,908 ] -       )
[ INFO : 2022-06-16 14:48:30,908 ] -     )
[ INFO : 2022-06-16 14:48:30,908 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 14:48:30,908 ] -       (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,908 ] -       (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,908 ] -       (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,908 ] -       (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,908 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,908 ] -     )
[ INFO : 2022-06-16 14:48:30,908 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 14:48:30,909 ] -       (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,909 ] -       (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,909 ] -       (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 14:48:30,909 ] -       (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,909 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 14:48:30,909 ] -     )
[ INFO : 2022-06-16 14:48:30,909 ] -   )
[ INFO : 2022-06-16 14:48:30,909 ] -   (pool): TSTP()
[ INFO : 2022-06-16 14:48:30,909 ] -   (seg_1): Linear(in_features=5120, out_features=256, bias=True)
[ INFO : 2022-06-16 14:48:30,909 ] -   (seg_bn_1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
[ INFO : 2022-06-16 14:48:30,909 ] -   (seg_2): Linear(in_features=256, out_features=256, bias=True)
[ INFO : 2022-06-16 14:48:30,909 ] -   (projection): ArcMarginProduct(
[ INFO : 2022-06-16 14:48:30,910 ] -     in_features=256, out_features=88503, scale=32.0,
[ INFO : 2022-06-16 14:48:30,910 ] -                       margin=0.0, easy_margin=False
[ INFO : 2022-06-16 14:48:30,910 ] -   )
[ INFO : 2022-06-16 14:48:30,910 ] - )
Traceback (most recent call last):
  File "/shared/workspaces/jprofant/GitHub/wespeaker/examples/voxceleb/v2/wespeaker/bin/train.py", line 217, in <module>
    fire.Fire(train)
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/shared/workspaces/jprofant/GitHub/wespeaker/examples/voxceleb/v2/wespeaker/bin/train.py", line 125, in train
    load_checkpoint(model, checkpoint)
  File "/shared/workspaces/jprofant/GitHub/wespeaker/wespeaker/utils/checkpoint.py", line 25, in load_checkpoint
    model.load_state_dict(checkpoint, strict=False)
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1482, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for ResNet:
	size mismatch for projection.weight: copying a param with shape torch.Size([17982, 256]) from checkpoint, the shape in current model is torch.Size([88503, 256]).
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'seg_1.weight', 'seg_1.bias', 'seg_bn_1.running_mean', 'seg_bn_1.running_var', 'seg_bn_1.num_batches_tracked', 'seg_2.weight', 'seg_2.bias', 'projection.weight'])