[ INFO : 2022-06-16 12:24:15,256 ] - training on multiple gpus, this gpu 0
[ INFO : 2022-06-16 12:24:15,257 ] - exp_dir is: exp/ResNet34-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150_rev-data
[ INFO : 2022-06-16 12:24:15,257 ] - <== Passed Arguments ==>
[ INFO : 2022-06-16 12:24:15,258 ] - {'data_type': 'shard',
[ INFO : 2022-06-16 12:24:15,258 ] -  'dataloader_args': {'batch_size': 192,
[ INFO : 2022-06-16 12:24:15,258 ] -                      'drop_last': True,
[ INFO : 2022-06-16 12:24:15,258 ] -                      'num_workers': 4,
[ INFO : 2022-06-16 12:24:15,258 ] -                      'pin_memory': False,
[ INFO : 2022-06-16 12:24:15,258 ] -                      'prefetch_factor': 4},
[ INFO : 2022-06-16 12:24:15,259 ] -  'dataset_args': {'aug_prob': 0.6,
[ INFO : 2022-06-16 12:24:15,259 ] -                   'fbank_args': {'dither': 1.0,
[ INFO : 2022-06-16 12:24:15,259 ] -                                  'frame_length': 25,
[ INFO : 2022-06-16 12:24:15,259 ] -                                  'frame_shift': 10,
[ INFO : 2022-06-16 12:24:15,259 ] -                                  'num_mel_bins': 80},
[ INFO : 2022-06-16 12:24:15,259 ] -                   'num_frms': 200,
[ INFO : 2022-06-16 12:24:15,259 ] -                   'shuffle': True,
[ INFO : 2022-06-16 12:24:15,259 ] -                   'shuffle_args': {'shuffle_size': 2500},
[ INFO : 2022-06-16 12:24:15,259 ] -                   'spec_aug': False,
[ INFO : 2022-06-16 12:24:15,259 ] -                   'spec_aug_args': {'max_f': 8,
[ INFO : 2022-06-16 12:24:15,259 ] -                                     'max_t': 10,
[ INFO : 2022-06-16 12:24:15,259 ] -                                     'num_f_mask': 1,
[ INFO : 2022-06-16 12:24:15,259 ] -                                     'num_t_mask': 1,
[ INFO : 2022-06-16 12:24:15,260 ] -                                     'prob': 0.6},
[ INFO : 2022-06-16 12:24:15,260 ] -                   'speed_perturb': True},
[ INFO : 2022-06-16 12:24:15,260 ] -  'exp_dir': 'exp/ResNet34-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150_rev-data',
[ INFO : 2022-06-16 12:24:15,260 ] -  'gpus': [0, 1, 2, 3],
[ INFO : 2022-06-16 12:24:15,260 ] -  'log_batch_interval': 100,
[ INFO : 2022-06-16 12:24:15,260 ] -  'loss': 'CrossEntropyLoss',
[ INFO : 2022-06-16 12:24:15,260 ] -  'loss_args': {},
[ INFO : 2022-06-16 12:24:15,260 ] -  'margin_scheduler': 'MarginScheduler',
[ INFO : 2022-06-16 12:24:15,260 ] -  'margin_update': {'final_margin': 0.2,
[ INFO : 2022-06-16 12:24:15,260 ] -                    'fix_start_epoch': 40,
[ INFO : 2022-06-16 12:24:15,260 ] -                    'increase_start_epoch': 20,
[ INFO : 2022-06-16 12:24:15,261 ] -                    'increase_type': 'exp',
[ INFO : 2022-06-16 12:24:15,261 ] -                    'initial_margin': 0.0,
[ INFO : 2022-06-16 12:24:15,261 ] -                    'update_margin': True},
[ INFO : 2022-06-16 12:24:15,261 ] -  'model': 'ResNet34',
[ INFO : 2022-06-16 12:24:15,261 ] -  'model_args': {'embed_dim': 256, 'feat_dim': 80, 'pooling_func': 'TSTP'},
[ INFO : 2022-06-16 12:24:15,261 ] -  'model_init': 'exp/ResNet101-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150/models/model_45.pt',
[ INFO : 2022-06-16 12:24:15,261 ] -  'noise_data': 'data/musan/lmdb',
[ INFO : 2022-06-16 12:24:15,261 ] -  'num_avg': 10,
[ INFO : 2022-06-16 12:24:15,261 ] -  'num_epochs': 150,
[ INFO : 2022-06-16 12:24:15,261 ] -  'optimizer': 'SGD',
[ INFO : 2022-06-16 12:24:15,261 ] -  'optimizer_args': {'momentum': 0.9, 'nesterov': True, 'weight_decay': 0.0001},
[ INFO : 2022-06-16 12:24:15,261 ] -  'projection_args': {'easy_margin': False,
[ INFO : 2022-06-16 12:24:15,261 ] -                      'project_type': 'arc_margin',
[ INFO : 2022-06-16 12:24:15,262 ] -                      'scale': 32.0},
[ INFO : 2022-06-16 12:24:15,262 ] -  'reverb_data': 'data/rirs/lmdb',
[ INFO : 2022-06-16 12:24:15,262 ] -  'save_epoch_interval': 5,
[ INFO : 2022-06-16 12:24:15,262 ] -  'scheduler': 'ExponentialDecrease',
[ INFO : 2022-06-16 12:24:15,262 ] -  'scheduler_args': {'final_lr': 5e-05, 'initial_lr': 0.1, 'warm_up_epoch': 6},
[ INFO : 2022-06-16 12:24:15,262 ] -  'seed': 42,
[ INFO : 2022-06-16 12:24:15,262 ] -  'train_data': 'data/train/shard.list',
[ INFO : 2022-06-16 12:24:15,262 ] -  'train_label': 'data/train/utt2spk'}
[ INFO : 2022-06-16 12:24:19,886 ] - <== Data statistics ==>
[ INFO : 2022-06-16 12:24:19,886 ] - train data num: 1747308, spk num: 29501
[ INFO : 2022-06-16 12:24:19,896 ] - <== Dataloaders ==>
[ INFO : 2022-06-16 12:24:19,896 ] - train dataloaders created
[ INFO : 2022-06-16 12:24:19,896 ] - loader size: 2275
[ INFO : 2022-06-16 12:24:19,896 ] - <== Model ==>
[ INFO : 2022-06-16 12:24:19,959 ] - Load initial model from exp/ResNet101-TSTP-emb256-fbank80-num_frms200-aug0.6-spTrue-saFalse-ArcMargin-SGD-epoch150/models/model_45.pt
[ INFO : 2022-06-16 12:24:20,236 ] - ResNet(
[ INFO : 2022-06-16 12:24:20,236 ] -   (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,236 ] -   (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,236 ] -   (layer1): Sequential(
[ INFO : 2022-06-16 12:24:20,237 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 12:24:20,237 ] -       (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,237 ] -       (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,237 ] -       (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,237 ] -       (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,237 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,237 ] -     )
[ INFO : 2022-06-16 12:24:20,237 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 12:24:20,237 ] -       (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,237 ] -       (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,237 ] -       (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,237 ] -       (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,238 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,238 ] -     )
[ INFO : 2022-06-16 12:24:20,238 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 12:24:20,238 ] -       (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,238 ] -       (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,238 ] -       (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,238 ] -       (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,238 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,238 ] -     )
[ INFO : 2022-06-16 12:24:20,238 ] -   )
[ INFO : 2022-06-16 12:24:20,238 ] -   (layer2): Sequential(
[ INFO : 2022-06-16 12:24:20,238 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 12:24:20,238 ] -       (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,239 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,239 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,239 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,239 ] -       (shortcut): Sequential(
[ INFO : 2022-06-16 12:24:20,239 ] -         (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
[ INFO : 2022-06-16 12:24:20,239 ] -         (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,239 ] -       )
[ INFO : 2022-06-16 12:24:20,239 ] -     )
[ INFO : 2022-06-16 12:24:20,239 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 12:24:20,239 ] -       (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,239 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,239 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,239 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,240 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,240 ] -     )
[ INFO : 2022-06-16 12:24:20,240 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 12:24:20,240 ] -       (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,240 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,240 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,240 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,240 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,240 ] -     )
[ INFO : 2022-06-16 12:24:20,240 ] -     (3): BasicBlock(
[ INFO : 2022-06-16 12:24:20,240 ] -       (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,241 ] -       (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,241 ] -       (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,241 ] -       (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,241 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,241 ] -     )
[ INFO : 2022-06-16 12:24:20,241 ] -   )
[ INFO : 2022-06-16 12:24:20,241 ] -   (layer3): Sequential(
[ INFO : 2022-06-16 12:24:20,241 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 12:24:20,241 ] -       (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,241 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,241 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,241 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,242 ] -       (shortcut): Sequential(
[ INFO : 2022-06-16 12:24:20,242 ] -         (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
[ INFO : 2022-06-16 12:24:20,242 ] -         (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,242 ] -       )
[ INFO : 2022-06-16 12:24:20,242 ] -     )
[ INFO : 2022-06-16 12:24:20,242 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 12:24:20,242 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,242 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,242 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,242 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,242 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,242 ] -     )
[ INFO : 2022-06-16 12:24:20,242 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 12:24:20,243 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,243 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,243 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,243 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,243 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,243 ] -     )
[ INFO : 2022-06-16 12:24:20,243 ] -     (3): BasicBlock(
[ INFO : 2022-06-16 12:24:20,243 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,243 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,243 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,243 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,243 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,244 ] -     )
[ INFO : 2022-06-16 12:24:20,244 ] -     (4): BasicBlock(
[ INFO : 2022-06-16 12:24:20,244 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,244 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,244 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,244 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,244 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,244 ] -     )
[ INFO : 2022-06-16 12:24:20,244 ] -     (5): BasicBlock(
[ INFO : 2022-06-16 12:24:20,244 ] -       (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,244 ] -       (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,244 ] -       (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,245 ] -       (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,245 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,245 ] -     )
[ INFO : 2022-06-16 12:24:20,245 ] -   )
[ INFO : 2022-06-16 12:24:20,245 ] -   (layer4): Sequential(
[ INFO : 2022-06-16 12:24:20,245 ] -     (0): BasicBlock(
[ INFO : 2022-06-16 12:24:20,245 ] -       (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,245 ] -       (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,245 ] -       (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,245 ] -       (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,245 ] -       (shortcut): Sequential(
[ INFO : 2022-06-16 12:24:20,245 ] -         (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
[ INFO : 2022-06-16 12:24:20,245 ] -         (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,246 ] -       )
[ INFO : 2022-06-16 12:24:20,246 ] -     )
[ INFO : 2022-06-16 12:24:20,246 ] -     (1): BasicBlock(
[ INFO : 2022-06-16 12:24:20,246 ] -       (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,246 ] -       (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,246 ] -       (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,246 ] -       (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,246 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,246 ] -     )
[ INFO : 2022-06-16 12:24:20,246 ] -     (2): BasicBlock(
[ INFO : 2022-06-16 12:24:20,246 ] -       (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,246 ] -       (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,247 ] -       (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
[ INFO : 2022-06-16 12:24:20,247 ] -       (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,247 ] -       (shortcut): Sequential()
[ INFO : 2022-06-16 12:24:20,247 ] -     )
[ INFO : 2022-06-16 12:24:20,247 ] -   )
[ INFO : 2022-06-16 12:24:20,247 ] -   (pool): TSTP()
[ INFO : 2022-06-16 12:24:20,247 ] -   (seg_1): Linear(in_features=5120, out_features=256, bias=True)
[ INFO : 2022-06-16 12:24:20,247 ] -   (seg_bn_1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
[ INFO : 2022-06-16 12:24:20,247 ] -   (seg_2): Linear(in_features=256, out_features=256, bias=True)
[ INFO : 2022-06-16 12:24:20,247 ] -   (projection): ArcMarginProduct(
[ INFO : 2022-06-16 12:24:20,247 ] -     in_features=256, out_features=88503, scale=32.0,
[ INFO : 2022-06-16 12:24:20,247 ] -                       margin=0.0, easy_margin=False
[ INFO : 2022-06-16 12:24:20,248 ] -   )
[ INFO : 2022-06-16 12:24:20,248 ] - )
[ INFO : 2022-06-16 12:24:21,058 ] - start_epoch: 1
[ INFO : 2022-06-16 12:24:21,096 ] - <== Loss ==>
[ INFO : 2022-06-16 12:24:21,096 ] - loss criterion is: CrossEntropyLoss
[ INFO : 2022-06-16 12:24:21,097 ] - <== Optimizer ==>
[ INFO : 2022-06-16 12:24:21,097 ] - optimizer is: SGD
[ INFO : 2022-06-16 12:24:21,097 ] - <== Scheduler ==>
[ INFO : 2022-06-16 12:24:21,097 ] - scheduler is: ExponentialDecrease
[ INFO : 2022-06-16 12:24:21,097 ] - <== MarginScheduler ==>
[ INFO : 2022-06-16 12:24:21,108 ] - <========== Training process ==========>
[ INFO : 2022-06-16 12:24:21,109 ] - +----------+----------+----------+----------+----------+----------+
[ INFO : 2022-06-16 12:24:21,109 ] - |     Epoch|     Batch|        Lr|    Margin|      Loss|       Acc|
[ INFO : 2022-06-16 12:24:21,109 ] - +----------+----------+----------+----------+----------+----------+
[ INFO : 2022-06-16 12:24:42,709 ] - Reducer buckets have been rebuilt in this iteration.
[ INFO : 2022-06-16 12:28:37,184 ] - |         1|       100|   0.10195|         0|    9.8999|    17.896|
[ WARNING : 2022-06-16 12:31:19,675 ] - TC0745902439P-1.aligned.wav_speaker00001-TC0745902439P-1.m4a-A-00695 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 12:32:56,771 ] - |         1|       200|   0.10391|         0|    8.1516|    26.193|
[ WARNING : 2022-06-16 12:34:41,409 ] - TC0569244830P-4.aligned.wav_speaker00000-TC0569244830P-4.m4a-A-00085 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 12:37:00,851 ] - |         1|       300|   0.10586|         0|     7.136|    31.844|
[ WARNING : 2022-06-16 12:39:58,731 ] - TC0569244830P-4.aligned.wav_speaker00001-TC0569244830P-4.m4a-A-00026 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 12:41:11,816 ] - |         1|       400|   0.10781|         0|     6.426|    36.165|
[ WARNING : 2022-06-16 12:41:47,584 ] - TC0569244830P-4.aligned.wav_speaker00001-TC0569244830P-4.m4a-A-00022 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 12:45:10,519 ] - |         1|       500|   0.10974|         0|    5.8983|    39.592|
[ INFO : 2022-06-16 12:49:17,262 ] - |         1|       600|   0.11167|         0|    5.4857|    42.382|
[ INFO : 2022-06-16 12:53:25,976 ] - |         1|       700|   0.11358|         0|    5.1581|    44.746|
[ WARNING : 2022-06-16 12:55:52,416 ] - TC0745902439P-1.aligned.wav_speaker00001-TC0745902439P-1.m4a-A-00691 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 12:57:30,325 ] - |         1|       800|   0.11549|         0|     4.873|    46.814|
[ INFO : 2022-06-16 13:01:48,398 ] - |         1|       900|   0.11738|         0|    4.6331|    48.615|
[ INFO : 2022-06-16 13:05:53,480 ] - |         1|      1000|   0.11927|         0|    4.4216|    50.262|
[ INFO : 2022-06-16 13:09:57,320 ] - |         1|      1100|   0.12115|         0|    4.2346|    51.704|
[ INFO : 2022-06-16 13:13:49,389 ] - |         1|      1200|   0.12302|         0|    4.0671|    53.011|
[ INFO : 2022-06-16 13:17:36,556 ] - |         1|      1300|   0.12488|         0|    3.9223|    54.207|
[ INFO : 2022-06-16 13:21:52,115 ] - |         1|      1400|   0.12674|         0|    3.7898|    55.279|
[ WARNING : 2022-06-16 13:24:08,503 ] - TC0569244830P-4.aligned.wav_speaker00000-TC0569244830P-4.m4a-A-00017 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 13:25:58,338 ] - |         1|      1500|   0.12858|         0|    3.6707|     56.26|
[ WARNING : 2022-06-16 13:29:47,502 ] - TC0569244830P-4.aligned.wav_speaker00000-TC0569244830P-4.m4a-A-00018 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 13:30:00,654 ] - |         1|      1600|   0.13041|         0|    3.5621|    57.167|
[ INFO : 2022-06-16 13:34:09,604 ] - |         1|      1700|   0.13224|         0|    3.4632|    58.005|
[ WARNING : 2022-06-16 13:35:06,045 ] - TC0569244830P-4.aligned.wav_speaker00000-TC0569244830P-4.m4a-A-00055 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 13:38:17,658 ] - |         1|      1800|   0.13406|         0|      3.37|    58.817|
[ INFO : 2022-06-16 13:42:27,093 ] - |         1|      1900|   0.13587|         0|    3.2859|    59.549|
[ INFO : 2022-06-16 13:46:41,150 ] - |         1|      2000|   0.13767|         0|    3.2082|    60.243|
[ INFO : 2022-06-16 13:50:39,815 ] - |         1|      2100|   0.13946|         0|    3.1367|    60.872|
[ INFO : 2022-06-16 13:54:52,043 ] - |         1|      2200|   0.14124|         0|    3.0687|    61.472|
[ INFO : 2022-06-16 13:57:58,420 ] - |         1|      2273|   0.14254|         0|    3.0227|    61.878|
[ WARNING : 2022-06-16 13:58:26,004 ] - TC0569244830P-4.aligned.wav_speaker00000-TC0569244830P-4.m4a-A-00065 probably empty. If you see this error often there might be a problem with your data.
[ INFO : 2022-06-16 14:02:11,691 ] - |         2|       100|   0.14434|         0|    1.5393|    75.078|
[ INFO : 2022-06-16 14:06:15,073 ] - |         2|       200|    0.1461|         0|    1.5425|    75.044|
/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py:305: ResourceWarning: unclosed file <_io.BufferedReader name='data/train/shards/shards_000000144.tar'>
  pass
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py:305: ResourceWarning: unclosed file <_io.BufferedReader name='data/train/shards/shards_000000098.tar'>
  pass
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py:305: ResourceWarning: unclosed file <_io.BufferedReader name='data/train/shards/shards_000001663.tar'>
  pass
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py:305: ResourceWarning: unclosed file <_io.BufferedReader name='data/train/shards/shards_000000214.tar'>
  pass
ResourceWarning: Enable tracemalloc to get the object allocation traceback
Traceback (most recent call last):
  File "/shared/workspaces/jprofant/GitHub/wespeaker/examples/voxceleb/v2/wespeaker/bin/train.py", line 217, in <module>
    fire.Fire(train)
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/shared/workspaces/jprofant/GitHub/wespeaker/examples/voxceleb/v2/wespeaker/bin/train.py", line 190, in train
    lr, margin, loss, acc = run_epoch(train_dataloader,
  File "/shared/workspaces/jprofant/GitHub/wespeaker/wespeaker/utils/executor.py", line 58, in run_epoch
    loss.backward()
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/shared/workspaces/jprofant/anaconda3/envs/wespeaker/lib/python3.9/site-packages/torch/autograd/__init__.py", line 154, in backward
    Variable._execution_engine.run_backward(
KeyboardInterrupt